<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yiling.goods.restriction.dao.GoodsPurchaseRestrictionCustomerMapper">
    <resultMap id="BaseResultMap" type="com.yiling.goods.restriction.entity.GoodsPurchaseRestrictionCustomerDO">
        <result column="id" property="id" />
        <result column="goods_id" property="goodsId" />
        <result column="customer_eid" property="customerEid" />
        <result column="del_flag" property="delFlag" />
        <result column="create_user" property="createUser" />
        <result column="create_time" property="createTime" />
        <result column="update_user" property="updateUser" />
        <result column="update_time" property="updateTime" />
        <result column="remark" property="remark" />
    </resultMap>

    <sql id="Base_Column_List">
        id,goods_id,customer_eid,
        del_flag,create_user,create_time,update_user,update_time,remark
    </sql>

    <sql id="insert_Column_List">
        goods_id,customer_eid,
        create_user,create_time,update_user,update_time
    </sql>

    <select id="getCustomerEidByGoodsId" resultType="java.lang.Long">
        select customer_eid
        from goods_purchase_restriction_customer
        where del_flag = 0
        and goods_id = #{goodsId}
    </select>
    <select id="getCustomerCountByGoodsId" resultType="java.lang.Long">
        select count(customer_eid)
        from goods_purchase_restriction_customer
        where del_flag = 0
        and goods_id = #{goodsId}
    </select>
    <insert id="batchSaveRestrictionCustomer">
        insert into goods_purchase_restriction_customer(<include refid="insert_Column_List"/>)
        values
        <foreach collection="request.customerEidList" item="item" index="index"
                 separator=",">
            (
            #{request.goodsId},
            #{item},
            #{request.opUserId},
            NOW(),
            #{request.opUserId},
            NOW()
            )
        </foreach>
    </insert>


</mapper>