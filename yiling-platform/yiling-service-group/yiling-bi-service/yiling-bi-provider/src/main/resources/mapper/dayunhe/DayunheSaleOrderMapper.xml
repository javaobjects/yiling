<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yiling.bi.dayunhe.dao.DayunheSaleOrderMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.yiling.bi.dayunhe.entity.DayunheSaleOrderDO">
    <result column="id" property="id" />
        <result column="supplier_name" property="supplierName" />
        <result column="sale_order" property="saleOrder" />
        <result column="goods_in_sn" property="goodsInSn" />
        <result column="so_batch_no" property="soBatchNo" />
        <result column="so_quantity" property="soQuantity" />
        <result column="goods_name" property="goodsName" />
        <result column="so_specifications" property="soSpecifications" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id,
        supplier_name, sale_order, goods_in_sn, so_batch_no, so_quantity, goods_name, so_specifications
    </sql>

    <select id="getFlowSaleExistsCount" resultType="integer">
        SELECT COUNT(1)
        FROM dayunhe_sale_order
        WHERE del_flag = 0
        AND eid = #{request.eid}
        AND specification_id = #{request.specificationId}
        AND so_batch_no=#{request.soBatchNo}
        AND enterprise_name = #{request.enterpriseName}
        AND so_time <![CDATA[ >= ]]> #{request.startSoTime}
        AND so_time <![CDATA[ <= ]]> #{request.endSoTime}
    </select>

    <select id="getFlowSaleExistsQuantity" resultType="java.math.BigDecimal">
        SELECT SUM(so_quantity)
        FROM dayunhe_sale_order
        WHERE del_flag = 0
        AND eid = #{request.eid}
        AND specification_id = #{request.specificationId}
        AND so_batch_no=#{request.soBatchNo}
        AND enterprise_name = #{request.enterpriseName}
        AND so_time <![CDATA[ >= ]]> #{request.startSoTime}
        AND so_time <![CDATA[ <= ]]> #{request.endSoTime}
    </select>

</mapper>
