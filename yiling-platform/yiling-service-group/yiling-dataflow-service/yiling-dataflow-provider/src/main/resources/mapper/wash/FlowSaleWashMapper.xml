<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yiling.dataflow.wash.dao.FlowSaleWashMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.yiling.dataflow.wash.entity.FlowSaleWashDO">
        <id column="id" property="id" />
        <result column="crm_enterprise_id" property="crmEnterpriseId" />
        <result column="fmwt_id" property="fmwtId" />
        <result column="year" property="year"/>
        <result column="month" property="month"/>
        <result column="flow_key" property="flowKey"/>
        <result column="eid" property="eid" />
        <result column="name" property="name" />
        <result column="so_id" property="soId" />
        <result column="so_no" property="soNo" />
        <result column="enterprise_inner_code" property="enterpriseInnerCode" />
        <result column="enterprise_name" property="enterpriseName" />
        <result column="crm_organization_id" property="crmOrganizationId" />
        <result column="crm_organization_name" property="crmOrganizationName" />
        <result column="license_number" property="licenseNumber" />
        <result column="so_time" property="soTime" />
        <result column="so_month" property="soMonth" />
        <result column="order_time" property="orderTime" />
        <result column="goods_in_sn" property="goodsInSn" />
        <result column="goods_name" property="goodsName" />
        <result column="so_specifications" property="soSpecifications" />
        <result column="so_batch_no" property="soBatchNo" />
        <result column="so_product_time" property="soProductTime" />
        <result column="so_effective_time" property="soEffectiveTime" />
        <result column="so_quantity" property="soQuantity" />
        <result column="so_unit" property="soUnit" />
        <result column="so_price" property="soPrice" />
        <result column="conversion_quantity" property="conversionQuantity" />
        <result column="so_manufacturer" property="soManufacturer" />
        <result column="so_license" property="soLicense" />
        <result column="so_source" property="soSource" />
        <result column="province_code" property="provinceCode" />
        <result column="province_name" property="provinceName" />
        <result column="city_code" property="cityCode" />
        <result column="city_name" property="cityName" />
        <result column="region_code" property="regionCode" />
        <result column="region_name" property="regionName" />
        <result column="crm_goods_code" property="crmGoodsCode" />
        <result column="crm_goods_name" property="crmGoodsName" />
        <result column="crm_goods_specifications" property="crmGoodsSpecifications" />
        <result column="enterprise_cers_id" property="enterpriseCersId" />
        <result column="organization_cers_id" property="organizationCersId" />
        <result column="wash_status" property="washStatus" />
        <result column="goods_mapping_status" property="goodsMappingStatus" />
        <result column="organization_mapping_status" property="organizationMappingStatus" />
        <result column="error_flag" property="errorFlag"/>
        <result column="error_msg" property="errorMsg"/>
        <result column="flow_classify" property="flowClassify"/>
        <result column="representative_code" property="representativeCode"/>
        <result column="unlock_flag" property="unlockFlag"/>
        <result column="create_type" property="createType"/>
        <result column="source_id" property="sourceId"/>
        <result column="del_flag" property="delFlag" />
        <result column="create_user" property="createUser" />
        <result column="create_time" property="createTime" />
        <result column="update_user" property="updateUser" />
        <result column="update_time" property="updateTime" />
        <result column="remark" property="remark" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, crm_enterprise_id, fmwt_id, year, month, flow_key, eid, name, so_id, so_no, enterprise_inner_code, enterprise_name, crm_organization_id, crm_organization_name, license_number, so_time, so_month, order_time, goods_in_sn, goods_name, so_specifications,
        so_batch_no, so_product_time, so_effective_time, so_quantity, so_unit, so_price, conversion_quantity, so_manufacturer, so_license, so_source, province_code, province_name, city_code,
        city_name, region_code, region_name, crm_goods_code, crm_goods_name, crm_goods_specifications, enterprise_cers_id, organization_cers_id, wash_status, goods_mapping_status,
        organization_mapping_status, error_flag, error_msg, flow_classify, representative_code, unlock_flag, create_type, source_id, del_flag, create_user, create_time, update_user, update_time, remark
    </sql>

    <select id="listPage" resultMap="BaseResultMap" >
        select
            <include refid="Base_Column_List"/>
        from flow_sale_wash
        <where>
            del_flag = 0
            <if test="request.fmwtId != null">
                and fmwt_id = #{request.fmwtId}
            </if>
            <if test="request.year != null">
                and year = #{request.year}
            </if>
            <if test="request.month != null">
                and month = #{request.month}
            </if>
            <if test="request.crmEnterpriseId != null ">
               and crm_enterprise_id = #{request.crmEnterpriseId}
            </if>
            <if test="request.crmEnterpriseIdList != null and request.crmEnterpriseIdList.size gt 0">
                and crm_enterprise_id in
                <foreach collection="request.crmEnterpriseIdList" separator="," open="(" close=")" item="crmEnterpriseId">
                    #{crmEnterpriseId}
                </foreach>
            </if>
            <if test="request.enterpriseName != null and request.enterpriseName != ''">
                and enterprise_name like #{request.enterpriseName}
            </if>
            <if test="request.crmOrganizationId != null">
                and crm_organization_id = #{request.crmOrganizationId}
            </if>
            <if test="request.goodsName != null and request.goodsName != ''">
                and goods_name like #{request.goodsName}
            </if>
            <if test="request.goodsSpec != null and request.goodsSpec != ''">
                and so_specifications like #{request.goodsSpec}
            </if>
            <if test="request.crmGoodsCode != null">
                and crm_goods_code = #{request.crmGoodsCode}
            </if>
            <if test="request.crmGoodsCodeList != null and request.crmGoodsCodeList.size gt 0">
                and crm_goods_code in
                <foreach collection="request.crmGoodsCodeList" separator="," open="(" close=")" item="crmGoodsCode" >
                    #{crmGoodsCode}
                </foreach>
            </if>
            <if test="request.goodsMappingStatus != null">
                and goods_mapping_status = #{request.goodsMappingStatus}
            </if>
            <if test="request.organizationMappingStatus != null">
                and organization_mapping_status = #{request.organizationMappingStatus}
            </if>
            <if test="request.washStatus != null">
                and wash_status = #{request.washStatus}
            </if>
            <if test="request.washStatusList != null and request.washStatusList.size gt 0">
                and wash_status in
                <foreach collection="request.washStatusList" separator="," open="(" close=")" item="washStatus" >
                    #{washStatus}
                </foreach>
            </if>
            <if test="request.startTime != null">
                and so_time <![CDATA[ >= ]]> #{request.startTime}
            </if>
            <if test="request.endTime != null">
                and so_time <![CDATA[ <= ]]> #{request.endTime}
            </if>
        </where>
        order by id desc
    </select>

    <select id="list" resultMap="BaseResultMap">
        select
            <include refid="Base_Column_List"/>
        from flow_sale_wash
        <where>
            del_flag = 0
            <if test="request.year != null">
                and year = #{request.year}
            </if>
            <if test="request.month != null">
                and month = #{request.month}
            </if>
            <if test="request.goodsName != null and request.goodsName != ''">
                and goods_name = #{request.goodsName}
            </if>
            <if test="request.soSpecifications != null and request.soSpecifications != ''">
                and so_specifications = #{request.soSpecifications}
            </if>
            <if test="request.crmGoodsCode != null">
                and crm_goods_code = #{request.crmGoodsCode}
            </if>
            <if test="request.enterpriseName != null and request.enterpriseName != ''">
                and enterprise_name = #{request.enterpriseName}
            </if>
            <if test="request.crmOrganizationId != null">
                and crm_organization_id = #{request.crmOrganizationId}
            </if>
        </where>
    </select>

    <select id="getPageByYearMonth" resultMap="BaseResultMap">
        select
            <include refid="Base_Column_List"/>
        from flow_sale_wash
        <where>
            del_flag = 0
            <if test="request.year != null">
                and year = #{request.year}
            </if>
            <if test="request.month != null">
                and month = #{request.month}
            </if>
            <if test="request.goodsName != null and request.goodsName != ''">
                and goods_name = #{request.goodsName}
            </if>
            <if test="request.goodsSpec != null and request.goodsSpec != ''">
                and so_specifications = #{request.goodsSpec}
            </if>
            <if test="request.crmGoodsCode != null">
                and crm_goods_code = #{request.crmGoodsCode}
            </if>
            <if test="request.enterpriseName != null and request.enterpriseName != ''">
                and enterprise_name = #{request.enterpriseName}
            </if>
            <if test="request.crmOrganizationId != null">
                and crm_organization_id = #{request.crmOrganizationId}
            </if>
        </where>
    </select>

</mapper>
