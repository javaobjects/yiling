<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yiling.user.esb.dao.EsbBackUpMapper">
    <update id="createBackupTable">
        CREATE TABLE ${backupTableName} like ${tableName}
    </update>

    <update id="addColumn">
        ALTER TABLE ${backupTableName} ADD COLUMN `backup_time` datetime(0) NULL DEFAULT CURRENT_TIMESTAMP COMMENT '备份时间'
    </update>
    <update id="renameBackupTable">
        ALTER TABLE ${backupTableName} RENAME AS ${newTableName}
    </update>
    <select id="getBackupTableCount" resultType="Long">
        select count(*)  as total from ${backupTableName}
    </select>
    <update id="insertBackupTableData">
        INSERT INTO  ${backupTableName} SELECT * FROM ${tableName}
    </update>
    <select id="getTableNames"  resultType="java.lang.String">
        SELECT table_name as tableName from information_schema.TABLEs WHERE table_schema in('yiling_test','yiling_dev','yiling_dev') and table_name like concat(#{esb,jdbcType=VARCHAR},'%')
    </select>
</mapper>
